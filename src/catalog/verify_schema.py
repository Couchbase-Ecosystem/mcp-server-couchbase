import json
from catalog.schema import parse_infer_output


infer_str = '[[{"#docs":2,"$schema":"http://json-schema.org/draft-06/schema","Flavor":"","properties":{"company":{"#docs":2,"%docs":100,"nestingDepth":0,"properties":{"departments":{"#docs":2,"%docs":100,"items":{"#docs":4,"$schema":"http://json-schema.org/draft-06/schema","Flavor":"","properties":{"name":{"#docs":4,"%docs":100,"nestingDepth":3,"type":"string"},"teams":{"#docs":4,"%docs":100,"items":{"#docs":2,"$schema":"http://json-schema.org/draft-06/schema","Flavor":"","properties":{"name":{"#docs":2,"%docs":100,"nestingDepth":5,"type":"string"},"projects":{"#docs":2,"%docs":100,"items":{"#docs":2,"$schema":"http://json-schema.org/draft-06/schema","properties":{"tasks":{"items":{"#docs":3,"$schema":"http://json-schema.org/draft-06/schema","properties":{"description":{"nestingDepth":9,"type":"string"},"status":{"nestingDepth":9,"type":"string"},"subtasks":{"items":{"#docs":5,"$schema":"http://json-schema.org/draft-06/schema","properties":{"completed":{"nestingDepth":11,"type":"boolean"},"subtask_id":{"nestingDepth":11,"type":"string"},"title":{"nestingDepth":11,"type":"string"}},"type":"object"},"maxItems":2,"minItems":1,"nestingDepth":9,"sampleSize":0,"type":"array"},"task_id":{"nestingDepth":9,"type":"number"}},"type":"object"},"maxItems":2,"minItems":1,"nestingDepth":7,"sampleSize":0,"type":"array"},"title":{"nestingDepth":7,"type":"string"}},"type":"object"},"maxItems":1,"minItems":1,"nestingDepth":5,"sampleSize":0,"type":"array"}},"type":"object"},"maxItems":1,"minItems":1,"nestingDepth":3,"sampleSize":0,"type":"array"}},"type":"object"},"maxItems":2,"minItems":2,"nestingDepth":1,"sampleSize":0,"samples":[[{"name":"Engineering","teams":[{"projects":[{"tasks":[{"description":"Train edge vision model","status":"in-progress","subtasks":[{"completed":false,"subtask_id":"1a","title":"Collect dataset"},{"completed":true,"subtask_id":"1b","title":"Data augmentation"}],"task_id":1},{"description":"Optimize inference runtime","status":"pending","subtasks":[{"completed":false,"subtask_id":"2a","title":"Quantization test"}],"task_id":2}],"title":"Edge AI Vision"}]}]},{"name":"Marketing","teams":[{"name":"Digital Campaigns","projects":[{"tasks":[{"status":"completed","subtasks":[{"title":"Prepare creatives"},{"completed":true,"subtask_id":"10b","title":"Schedule posts"}],"task_id":10}],"title":"AI Product Launch"}]}]}],[{"name":"Engineering","teams":[{"name":"AI Research","projects":[{"tasks":[{"description":"Train edge vision model","status":"in-progress","subtasks":[{"completed":false,"subtask_id":"1a","title":"Collect dataset"},{"completed":true,"subtask_id":"1b","title":"Data augmentation"}],"task_id":1},{"description":"Optimize inference runtime","status":"pending","subtasks":[{"completed":false,"subtask_id":"2a","title":"Quantization test"}],"task_id":2}],"title":"Edge AI Vision"}]}]},{"name":"Marketing","teams":[{"name":"Digital Campaigns","projects":[{"tasks":[{"description":"Social media rollout","status":"completed","subtasks":[{"completed":true,"subtask_id":"10a","title":"Prepare creatives"},{"completed":true,"subtask_id":"10b","title":"Schedule posts"}],"task_id":10}],"title":"AI Product Launch"}]}]}]],"type":"array"},"name":{"#docs":2,"%docs":100,"nestingDepth":1,"samples":["TechNova"],"type":"string"}},"samples":[{"departments":[{"name":"Engineering","teams":[{"projects":[{"tasks":[{"description":"Train edge vision model","status":"in-progress","subtasks":[{"completed":false,"subtask_id":"1a","title":"Collect dataset"},{"completed":true,"subtask_id":"1b","title":"Data augmentation"}],"task_id":1},{"description":"Optimize inference runtime","status":"pending","subtasks":[{"completed":false,"subtask_id":"2a","title":"Quantization test"}],"task_id":2}],"title":"Edge AI Vision"}]}]},{"name":"Marketing","teams":[{"name":"Digital Campaigns","projects":[{"tasks":[{"status":"completed","subtasks":[{"title":"Prepare creatives"},{"completed":true,"subtask_id":"10b","title":"Schedule posts"}],"task_id":10}],"title":"AI Product Launch"}]}]}],"name":"TechNova"},{"departments":[{"name":"Engineering","teams":[{"name":"AI Research","projects":[{"tasks":[{"description":"Train edge vision model","status":"in-progress","subtasks":[{"completed":false,"subtask_id":"1a","title":"Collect dataset"},{"completed":true,"subtask_id":"1b","title":"Data augmentation"}],"task_id":1},{"description":"Optimize inference runtime","status":"pending","subtasks":[{"completed":false,"subtask_id":"2a","title":"Quantization test"}],"task_id":2}],"title":"Edge AI Vision"}]}]},{"name":"Marketing","teams":[{"name":"Digital Campaigns","projects":[{"tasks":[{"description":"Social media rollout","status":"completed","subtasks":[{"completed":true,"subtask_id":"10a","title":"Prepare creatives"},{"completed":true,"subtask_id":"10b","title":"Schedule posts"}],"task_id":10}],"title":"AI Product Launch"}]}]}],"name":"TechNova"}],"type":"object"},"~meta":{"#docs":2,"%docs":100,"nestingDepth":0,"properties":{"id":{"#docs":2,"%docs":100,"nestingDepth":1,"samples":["doc1","doc4"],"type":"string"}},"samples":[{"id":"doc1"},{"id":"doc4"}],"type":"object"}},"type":"object"},{"#docs":1,"$schema":"http://json-schema.org/draft-06/schema","Flavor":"","properties":{"company":{"#docs":1,"%docs":100,"nestingDepth":0,"properties":{"departments":{"#docs":1,"%docs":100,"items":{"type":"number"},"maxItems":1,"minItems":1,"nestingDepth":1,"sampleSize":0,"samples":[[5]],"type":"array"},"name":{"#docs":1,"%docs":100,"nestingDepth":1,"samples":[5555],"type":"number"}},"samples":[{"departments":[5],"name":5555}],"type":"object"},"temp":{"#docs":1,"%docs":100,"items":[{"type":"number"},{"type":"string"},{"#docs":1,"$schema":"http://json-schema.org/draft-06/schema","Flavor":"`cc` = 1","properties":{"cc":{"#docs":1,"%docs":100,"nestingDepth":2,"samples":[1],"type":"number"}},"type":"object"}],"maxItems":3,"minItems":3,"nestingDepth":0,"sampleSize":0,"samples":[[1,"232",{"cc":1}]],"type":"array"},"~meta":{"#docs":1,"%docs":100,"nestingDepth":0,"properties":{"id":{"#docs":1,"%docs":100,"nestingDepth":1,"samples":["doc3"],"type":"string"}},"samples":[{"id":"doc3"}],"type":"object"}},"type":"object"},{"#docs":1,"$schema":"http://json-schema.org/draft-06/schema","Flavor":"","properties":{"company":{"#docs":1,"%docs":100,"nestingDepth":0,"properties":{"name":{"#docs":1,"%docs":100,"nestingDepth":1,"samples":["TechNova"],"type":"string"}},"samples":[{"name":"TechNova"}],"type":"object"},"departments":{"#docs":1,"%docs":100,"nestingDepth":0,"properties":{"name":{"#docs":1,"%docs":100,"nestingDepth":1,"samples":["Arts"],"type":"string"}},"samples":[{"name":"Arts"}],"type":"object"},"temp":{"#docs":1,"%docs":100,"items":[{"type":"number"},{"type":"string"}],"maxItems":2,"minItems":2,"nestingDepth":0,"sampleSize":0,"samples":[[2,"532"]],"type":"array"},"~meta":{"#docs":1,"%docs":100,"nestingDepth":0,"properties":{"id":{"#docs":1,"%docs":100,"nestingDepth":1,"samples":["doc2"],"type":"string"}},"samples":[{"id":"doc2"}],"type":"object"}},"type":"object"}]]'
infer_dict = json.loads(infer_str)
out= parse_infer_output(infer_dict)
print(out.to_dict())